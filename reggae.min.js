(function(){function a(a){return new b(a)}function b(a){if(a instanceof Array)this.arr=a;else throw new TypeError("first argument should be array")}function c(a){return new d(a)}function d(a){if(typeof a!="function")throw new TypeError("first argument should be function");this.func=a}function e(a){return new f(a)}function f(a){if(typeof a!="object")throw new TypeError("first argument should be object");this.obj=a}function h(){this.parts=[],this.flags={global:!1,ignoreCase:!1,multiline:!1}}function i(a){h.call(this);var b="",c=/^[\\{}*+?()|\[\]\^$.]$/,d=/^\\(?:[bBdDfnrsStvwW0]|c[A-Z]|x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4})$/,e=/^\[\\b\]$/;if(c.test(a))b="\\"+a;else if(a.length===1||d.test(a)||e.test(a))b=a;else throw new SyntaxError(a+" is not a single character or valid escape sequence");this.pattern=function(){return b}}"use strict",b.prototype.forEach=function(a){for(var b=0;b<this.arr.length;b+=1)a.call(this.arr,b,this.arr[b]);return this},d.prototype.extend=function(a){if(typeof a!="function")throw new TypeError(a+"first argument should be function");var b=function(){};return b.prototype=a.prototype,this.func.prototype=new b,this.func.prototype.constructor=this.func,this.func.uber=a.prototype,this},f.prototype.forEach=function(a){for(var b in this.obj)this.obj.hasOwnProperty(b)&&a.call(this.obj,b,this.obj[b]);return this};var g={bound:"b",nobound:"B",digit:"d",nodigit:"D",space:"s",nospace:"S",word:"w",noword:"W",formfeed:"f",newline:"n",ret:"r",anything:".",tab:"t",vtab:"v",nul:"0"};h.prototype.target=function(){return this},h.prototype.pattern=function(){var b="";return a(this.parts).forEach(function(a,c){b+=c.pattern()}),b+=this.flags.global?"g":"",b+=this.flags.ignoreCase?"i":"",b+=this.flags.multiline?"m":"",b},h.prototype.make=function(){return new RegExp(this.pattern())},h.prototype.flag=function(a){if(typeof a!="string")throw new TypeError("flagName should be string");var b=this.target();return b.flags[a]=!0,b},h.prototype.global=function(){return this.flag("global")},h.prototype.ignoreCase=function(){return this.flag("ignoreCase")},h.prototype.multiline=function(){return this.flag("multiline")},h.prototype.append=function(a){if(a instanceof h){var b=this.target();return b.parts.push(a),b}throw new TypeError("expression should be instance of RegExpression")},c(i).extend(h),i.escape=function(a){if(typeof a!="string"||a.length!==1)throw new Error(a+"is not a single character");return new i("\\"+a)},i.control=function(a){var b=/^[A-Z]$/;if(!b.test(a))throw new SyntaxError(a+" is not an uppercase letter");return new i("\\c"+a)},i.hex=function(a){var b=/^[0-9a-fA-F]{2}$/;if(!b.test(a))throw new SyntaxError(a+" is not a pair of hex digits");return new i("\\x"+a)},i.unicode=function(a){var b=/^[0-9a-fA-F]{4}$/;if(!b.test(a))throw new SyntaxError(a+" is not four hex digits");return new i("\\u"+a)},i.backspace=function(){return new i("[\\b]")},e(g).forEach(function(a,b){i[a]=function(){return i.escape(b)},h.prototype[a]=function(){return this.target().append(i[a]())}});var j=window||global||this;j.reg||(j.reg=new h),j.reg.target=function(){return new h}})();